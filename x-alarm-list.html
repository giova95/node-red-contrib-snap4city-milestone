<!--/* NODE-RED-CONTRIB-SNAP4CITY-MILESTONE
   Copyright (C) 2023 DISIT Lab http://www.disit.org - University of Florence

   This program is free software: you can redistribute it and/or modify
   it under the terms of the GNU Affero General Public License as
   published by the Free Software Foundation, either version 3 of the
   License, or (at your option) any later version.

   This program is distributed in the hope that it will be useful,
   but WITHOUT ANY WARRANTY; without even the implied warranty of
   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
   GNU Affero General Public License for more details.

   You should have received a copy of the GNU Affero General Public License
   along with this program.  If not, see <http://www.gnu.org/licenses/>. */-->

<script type="text/javascript">
    RED.nodes.registerType('x-alarm-list', {
        category: 'S4CMilestone',
        color: '#fde910',
        icon: 'icons/logocam.png',
        inputs: 1,
        outputs: 1,
        label: function () {
            return this.name || 'Print Alarm or Event List From XProtect';
        },
        defaults: {
            maxLines: { type: 'text' },
            order: { type: 'text' },
            target: { type: 'text' },
        }
    });
</script>

<script type="text/html" data-template-name="x-alarm-list">
    <div class="form-row">
        <label for="node-input-maxLines"><i class="fa fa-tag"></i> Max lines</label>
        <input type="text" id="node-input-maxLines" placeholder="Max lines">
    </div>
    <div class="form-row">
        <label for="node-input-order"><i class="fa fa-tag"></i>Order</label>
        <select id="node-input-order" type="text">
            <option value ="Descending">Descending</option>
            <option value="Ascending">Ascending</option>
        </select>
    </div>
    <div class="form-row">
        <label for="node-input-target"><i class="fa fa-tag"></i> Target</label>
        <select id="node-input-target" type="text">
            <option value="LocalId">Id</option>
            <option value="Timestamp">Timestamp</option>
            <option value="StateName">StateName</option>
            <option value="SourceName">SourceName</option>
            <option value="Type">Type</option>
        </select>
    </div>
</script>

<script type="text/x-red" data-help-name="x-alarm-list">
    <p>With this node you can send an event to the event server and trigger an Alarm with the possibility to activate a rule associated with it.</p>
    
    <h3>Inputs</h3>
    <p>A JSON with these parameters:</p>
    
    <dl class="message-properties">
       <dt>Max Lines
           <span class="property-type">string</span>
       </dt>
       <dd>Max lines of alarm to display from the event server</dd>
       
       <dt>Order
           <span class="property-type">string</span>
       </dt>
       <dd>The sorting type for the alarms.(Basically descending/ascending displayed in a drop-down menu in node properties).</dd>
       
       <dt>Target
            <span class="property-type">string</span>
       </dt>
       <dd>The target property of the sorting for the alarms.(They're displayed with a drop-down menu in node properties).</dd>
    </dl>

    <h3>Outputs</h3>
     <dl class="message-properties">
         <dd>A JSON file containing an alarm list received from the event server with information about them.</dd>
     </dl>
     
    <h3>Details</h3>
     <p>The node can receive the parameters described in the Inputs section, with them generates a XML file with which a SOAP request is sent to the event server. 
        A server response with the alarm list generates the output JSON. If the values are not present in the input JSON, these are read by those in the node properties. 
        If they are not present in either part or are wrong, an error is generated for the necessary parameters or the reason why are not correct.</p>
</script>